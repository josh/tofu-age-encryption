env AGE_RECIPIENTS=age1s2r63x2q98nmv8ppjv5c2zv5xlm4lp0makhmtsumglwhhwnt2e5srs47qt
env AGE_KEY_FILE=$WORK/key.txt
stdin plain.json
exec tofu-age-encryption --encrypt

stdin stdout
exec tail -n +2
cp stdout cipher.json
stdin cipher.json
exec tofu-age-encryption --decrypt
cmp stdout stdout.json
cmp stderr stderr.txt

-- plain.json --
{"payload":"c2VjcmV0"}

-- key.txt --
# created: 2025-09-05T17:27:52-07:00
# public key: age1s2r63x2q98nmv8ppjv5c2zv5xlm4lp0makhmtsumglwhhwnt2e5srs47qt
AGE-SECRET-KEY-1PM25GKMYEWAKGVNM44FPMFXMEEGVDTXUEN3H3LNH2JACJA0UNZPQG00E7N

-- stdout.json --
{"magic":"OpenTofu-External-Encryption-Method","version":1}
{"payload":"c2VjcmV0"}
-- stderr.txt --
